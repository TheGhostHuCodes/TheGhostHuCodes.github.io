<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; style-src-attr 'unsafe-inline'">

    <title>Building googletest 1.7.0 on Ubuntu | The Ghost Hu Codes</title>

    <link rel="preload" href="https://theghosthucodes.github.io/fonts/FiraCode-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="https://theghosthucodes.github.io/fonts/FiraCode-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://theghosthucodes.github.io/css/style.css?h=fd30ebca55fd38ab02dd">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ¦€</text></svg>">
    <script src="https://theghosthucodes.github.io/js/auto-close-popover-on-resize.js?h=4ef87d6fc7b98b22e044" defer></script>
    <script src="https://theghosthucodes.github.io/js/copy-code-to-clipboard.js?h=6aac77c47d552a0ac847" defer></script>
    <script src="https://theghosthucodes.github.io/js/theme-switcher.js?h=8b328788f681e02ea11e" defer></script>

    <link rel="canonical" href="https://theghosthucodes.github.io/blog/building-gtest-1-7-on-ubuntu/">
    
    <meta name="author" content="Yung-Jin (Joey) Hu">
    <meta name="description" content="The one in which I build a C++ unit test framework because testing is important.">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#211f1a">
    <meta name="color-scheme" content="dark">

    <meta property="og:title" content="Building googletest 1.7.0 on Ubuntu">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://theghosthucodes.github.io/blog/building-gtest-1-7-on-ubuntu/">
    <meta property="og:description" content="The one in which I build a C++ unit test framework because testing is important.">
    <meta property="og:site_name" content="The Ghost Hu Codes">
    <meta property="og:updated_time" content="2025-09-29T03:30:56.709241261+00:00">
    <meta property="article:published_time" content="2015-01-01T00:00:00+00:00">
    <meta property="article:tag" content="googletest">
    <meta property="article:tag" content="c++">
    <meta property="article:tag" content="unit-testing">
</head>

<body class="layout-center">
    <header class="header">
        <div class="header-container">
            <span class="header-logo-container">
                <a href="https://theghosthucodes.github.io">
                    <span class="logo">The Ghost Hu Codes</span>
                </a>
            </span>
        </div>
        <nav class="main-menu" aria-label="Main Menu">
            <a class="skip-to-content" href="#main">Skip to main content</a>
            <button class="main-menu-dropdown-button" popovertarget="nav-menu">Menu</button>
            <ul id="nav-menu" class="main-menu-items" aria-label="Site Navigation" popover>
                <li><a href="https://theghosthucodes.github.io/blog/">blog</a></li>
                <li><a href="https://theghosthucodes.github.io/about/">about</a></li>
                <li><a href="https://theghosthucodes.github.io/tags/">tags</a></li>
            </ul>
        </nav>
    </header>
    <main id="main">
        <article class="post content">
            <header>
                <h1 class="post-title">
                    <a href="https://theghosthucodes.github.io/blog/building-gtest-1-7-on-ubuntu/">Building googletest 1.7.0 on Ubuntu</a>
                </h1>
                <ul class="post-meta">
                    <li title="Published on 2015-01-01"><time datetime="2015-01-01">2015.01.01</time></li>
                    <li role="separator" aria-hidden="true">::</li>
                    <li title="371 words"><time datetime="PT2M">2 min</time> read</li>
                </ul>
                <div class="post-tags">
                    <span>#<a rel="tag" href="https://theghosthucodes.github.io/tags/googletest/">googletest</a></span>
                    <span>#<a rel="tag" href="https://theghosthucodes.github.io/tags/c/">c++</a></span>
                    <span>#<a rel="tag" href="https://theghosthucodes.github.io/tags/unit-testing/">unit-testing</a></span>
                </div>
            </header>

<p>Unit testing is awesome. Working with legacy code, not so much. Of course when
I say <a href="http://www.amazon.com/Working-Effectively-Legacy-Michael-Feathers/dp/0131177052">legacy
code</a>,
I actually mean what Michael Feathers means: code that has no unit tests.</p>
<p>A while back I was getting started with googletest on Ubuntu and ran into
<a href="http://www.thebigblob.com/getting-started-with-google-test-on-ubuntu/">this</a>
great post. Sadly, the libgtest-dev package does not install the static
libraries, and the Ubuntu 14.04 repo is still stuck on the 1.6.0 version. Can we
do better (other than upgrading to 14.10)? Sure we can! Let's grab the latest
source from the <a href="https://code.google.com/p/googletest/">googletest website</a> and
build our own! Of course, along the way we're going to build and run the
tests for googletest too. How meta. We're going to need <code>cmake</code>.</p>
<pre data-lang="shell" style="background-color:#002b36;color:#839496;" class="language-shell "><code class="language-shell" data-lang="shell"><span>$ sudo apt-get install cmake
</span></code></pre>
<p>Unzip the googletest source in your directory of choice. I'm a big fan of using
<code>/usr/local/src</code> but it's really a personal preference. Change to that
directory and run the following cmake command to build the googletest static
libraries in release mode and the googletest tests (case matters here for the
cmake switches):</p>
<pre data-lang="sh" style="background-color:#002b36;color:#839496;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#b58900;">$</span><span> sudo cmake</span><span style="color:#268bd2;"> -DCMAKE_BUILD_TYPE</span><span style="color:#657b83;">=</span><span>RELEASE</span><span style="color:#268bd2;"> -Dgtest_build_tests</span><span style="color:#657b83;">=</span><span>ON
</span><span style="color:#b58900;">$</span><span> sudo make
</span></code></pre>
<p>Next we launch the tests like so:</p>
<pre data-lang="sh" style="background-color:#002b36;color:#839496;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#b58900;">$</span><span> make test
</span></code></pre>
<p>and you should see output that looks something like this:</p>
<pre data-lang="sh" style="background-color:#002b36;color:#839496;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#b58900;">Running</span><span> tests...
</span><span style="color:#b58900;">Test</span><span> project /usr/local/src/gtest-1.7.0
</span><span>     </span><span style="color:#b58900;">Start</span><span>  1: gtest-death-test_test
</span><span style="color:#b58900;">1/41</span><span> Test  </span><span style="color:#586e75;">#1: gtest-death-test_test ..............   Passed    0.84 sec
</span><span>     </span><span style="color:#b58900;">Start</span><span>  2: gtest_environment_test
</span><span style="color:#b58900;">2/41</span><span> Test  </span><span style="color:#586e75;">#2: gtest_environment_test .............   Passed    0.00 sec
</span><span>     </span><span style="color:#b58900;">Start</span><span>  3: gtest-filepath_test
</span><span style="color:#b58900;">3/41</span><span> Test  </span><span style="color:#586e75;">#3: gtest-filepath_test ................   Passed    0.01 sec
</span><span style="color:#b58900;">...
</span></code></pre>
<p>Make sure that all of the tests pass. Now it's time to toss your compiled
libraries somewhere that cmake will be able to find them:</p>
<pre data-lang="sh" style="background-color:#002b36;color:#839496;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#b58900;">$</span><span> sudo cp libgtest</span><span style="color:#859900;">*</span><span> /usr/lib
</span></code></pre>
<p>We're going to need to add this line to our .zshrc (or similar shell) file so
that cmake will be able to find the googletest headers.</p>
<pre data-lang="sh" style="background-color:#002b36;color:#839496;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#93a1a1;">export </span><span style="color:#268bd2;">GTEST_ROOT</span><span style="color:#657b83;">=</span><span>&quot;</span><span style="color:#2aa198;">/usr/local/src/gtest-1.7.0</span><span>&quot;
</span></code></pre>
<p>How did I know this? Well if you look in the file
<code>/usr/share/cmake-2.8/Modules/FindGTest.cmake</code> you will find the following
section:</p>
<pre data-lang="cmake" style="background-color:#002b36;color:#839496;" class="language-cmake "><code class="language-cmake" data-lang="cmake"><span style="color:#859900;">find_path</span><span style="color:#657b83;">(</span><span>GTEST_INCLUDE_DIR gtest/gtest.h
</span><span>    </span><span style="color:#268bd2;">HINTS
</span><span>        </span><span style="color:#859900;">$ENV</span><span style="color:#657b83;">{</span><span style="color:#268bd2;">GTEST_ROOT</span><span style="color:#657b83;">}</span><span>/include
</span><span>        </span><span style="color:#859900;">$</span><span style="color:#657b83;">{</span><span style="color:#268bd2;">GTEST_ROOT</span><span style="color:#657b83;">}</span><span>/include
</span><span style="color:#657b83;">)
</span></code></pre>
<p>Because we're building googletest from source in an unconventional directory,
we'll need to give cmake a hint as to where the googletest headers are.</p>
<p>If you didn't want to add the environment variable, you could also have passed
the location of the googletest headers as a switch to cmake:</p>
<pre data-lang="cmake" style="background-color:#002b36;color:#839496;" class="language-cmake "><code class="language-cmake" data-lang="cmake"><span>$ </span><span style="color:#b58900;">cmake</span><span> -DGTEST_ROOT=&quot;/usr/local/src/gtest-1.7.0/&quot;
</span></code></pre>
<p>Now we're all set. You can check everything is working by going back to
<a href="http://www.thebigblob.com/getting-started-with-google-test-on-ubuntu/">this</a>
post and copy-pasta the source code and tests. Happy building!</p>

        </article>
        <nav class="post-navigation">
            <header class="post-navigation-title">
                <h2>Read More Posts</h2>
                <hr>
            </header>
            <div class="post-navigation-buttons">
                <a rel="next" href="https://theghosthucodes.github.io/blog/setting-up-an-ubuntu-server-on-azure/" aria-label="Next article">
                    <span aria-hidden="true">&lt;&nbsp;[</span>Setting up an Ubuntu server in Azure<span aria-hidden="true">]</span>
                </a>
                <span aria-hidden="true" role="separator">::</span>
                <a rel="prev" href="https://theghosthucodes.github.io/blog/building-potion-lang/" aria-label="Prev article">
                    <span aria-hidden="true">[</span>Building Potion<span aria-hidden="true">]&nbsp;&gt;</span>
                </a>
            </div>
        </nav>
    </main>
    <footer class="footer">
        <address class="socials">
            <ul>
                <li>
                    <a class="social-link" rel="me" href="https://github.com/TheGhostHuCodes" title="github">
                        <svg role="img" aria-label="github">
                            <use aria-hidden="true" href="https://theghosthucodes.github.io/images/social_icons/github.svg#icon" />
                        </svg>
                    </a>
                </li>
                <li>
                    <a class="social-link" rel="me" href="https://www.linkedin.com/in/yungjinhu/" title="linkedin">
                        <svg role="img" aria-label="linkedin">
                            <use aria-hidden="true" href="https://theghosthucodes.github.io/images/social_icons/linkedin.svg#icon" />
                        </svg>
                    </a>
                </li>
                <li>
                    <a class="social-link" rel="me" href="https://stackoverflow.com/users/1701171/pythonjin" title="stackoverflow">
                        <svg role="img" aria-label="stackoverflow">
                            <use aria-hidden="true" href="https://theghosthucodes.github.io/images/social_icons/stackoverflow.svg#icon" />
                        </svg>
                    </a>
                </li>
            </ul>
        </address>
        <p class="copyright">
            <span>Â© <time>2025</time> Yung-Jin (Joey) Hu</span>
            <span>Powered by <a href="https://www.getzola.org">Zola</a></span>
            <span>Theme by <a href="https://eyalkalderon.com">ebkalderon</a></span>
        </p>
    </footer>
</body>

</html>
